<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Description</title>
    <style>
        /* CSS样式 */
        pre {
            background-color: #f5f5f5;
            padding: 10px;
            border: 1px solid #ccc;
            font-family: "Courier New", monospace;
        }

        .keyword {
            color: blue;
        }

        .string {
            color: green;
        }

        .comment {
            color: gray;
        }
    </style>
</head>
<body>
<h2>Postgresql数据库端不建立外键关系，odoo ORM保留外键关系</h2>

<p>组件使用方式，在外键字段上设置属性db_constraint=False，将会在数据库层将外键关系解除，保留orm层的外键关系</p>

<pre><code class="language-python">
class Author(models.Model):
    <em>name = &#39;xcj.author&#39;
    name = fields.Char(string=&quot;姓名&quot;)
    book</em>ids = fields.One2many(&quot;xcj.book&quot;, &quot;author_id&quot;, string=&quot;作品&quot;)

class Book(models.Model):
    <em>name = &#39;xcj.book&#39;
    name = fields.Char(string=&quot;数目&quot;)
    code = fields.Char(string=&quot;编号&quot;)
    author</em>id = fields.Many2one(&quot;xcj.author&quot;, string=&quot;作者&quot;, db<em>constraint=False)
    author</em>ids = fields.Many2many(&quot;xcj.author&quot;, &quot;xcj<em>book</em>authors&quot;, &quot;book<em>id&quot;, &quot;author</em>id&quot;, string=&quot;作者&quot;, db_constraint=False)
</code>
</pre>

<h3>设置为True或者不配置db_constraint</h3>


<pre><code class="language-python">author_id = fields.Many2one(&quot;xcj.author&quot;, string=&quot;作者&quot;)
author_ids = fields.Many2many(&quot;xcj.author&quot;, &quot;xcj_book_authors&quot;, &quot;book_id&quot;, &quot;author_id&quot;, string=&quot;作者&quot;)

或

author_id = fields.Many2one(&quot;xcj.author&quot;, string=&quot;作者&quot;, db_constraint=True)
author_ids = fields.Many2many(&quot;xcj.author&quot;, &quot;xcj_book_authors&quot;, &quot;book_id&quot;, &quot;author_id&quot;, string=&quot;作者&quot;, db_constraint=True)
</code></pre>

<p>
    <img alt="db_constraint_true.png" src="../img/db_constraint_true.png"/></p>

<h3>设置为False（将不会建立数据库层面的外键关系）</h3>

<pre><code class="language-python">
author_id = fields.Many2one(&quot;xcj.author&quot;, string=&quot;作者&quot;, db_constraint=False)
author_ids = fields.Many2many(&quot;xcj.author&quot;, &quot;xcj_book_authors&quot;, &quot;book_id&quot;, &quot;author_id&quot;, string=&quot;作者&quot;, db_constraint=False)
</code></pre>

<p>
    <img alt="db_constraint_false.png" src="../img/db_constraint_false.png"/></p>

</body>
</html>
